<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title></title>
    <link rel="stylesheet" href="../css/style.css" />
    <meta name="description" content="" />

    <meta property="og:title" content="" />
    <meta property="og:type" content="" />
    <meta property="og:url" content="" />
    <meta property="og:image" content="" />
    <meta property="og:image:alt" content="" />

    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/icon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="icon.png" />

    <link rel="manifest" href="../site.webmanifest" />
    <meta name="theme-color" content="#fafafa" />
  </head>

  <body>
    <h1>Ejercicio Anotador</h1>
    <ul>
      <li><a href="../index.html">Volver</a></li>
    </ul>
    <script>
      /*
  
## Librer√≠a con Libros con Autor

  ### Autor
  - **Propiedades**
    - nombre (string)
    - nacionalidad (string)
  - **Constructor**
    - pide como argumentos `nombre` y `nacionalidad` y los asigna a sus respectivas propiedades
  - **M√©todos**
      - getters para obtener los valores de todas las propiedades

  ### Libro
  - **Propiedades**
    - id (string)
    - titulo (string)
    - autor (`Autor`)
    - precio (n√∫mero)
    - genero (string)
    - stock (n√∫mero)
  - **Constructor**
    - genera un `id` autom√°tico y lo asigna a su propiedad
    - el resto de propiedades las pide como argumentos y las asigna seg√∫n corresponda
  - **M√©todos**
    - **`tieneStock()`** devuelve `true` si `stock` es mayor a 0, `false` sino
    - getters para obtener los valores de todas las propiedades, menos `stock`
    - setter para modificar los valores de `precio` y `stock`
  - **Observaciones**
    - `stock` y `precio` tienen como valor m√≠nimo 0

  ### Libreria
  - **Propiedades**
    - libros (array de `Libro), inicializa vac√≠o
    - ganancias (n√∫mero), inicializa en 0
  - **M√©todos**
    - **`agregar(libro)`** agrega `libro` a `libros`
    - **`eliminar(id)`** elimina de `libros` el libro con `id`
    - **`buscarPorId(id)`** devuelve la informaci√≥n de un libro con `id`
    - **`buscarPorTitulo(titulo)`** devuelve la informaci√≥n de un libro con `titulo`
    - **`filtrarPorAutor(autor)`** devuelve un array de libros escritos por `autor`
    - **`filtrarPorGenero(genero)`** devuelve un array de libros con `genero`
    - **`comprarLibros(idLibros)`** toma un array de ids de libros, si tienen stock, reduce el stock de dichos libros en 1 y suma a ganancias el precio de cada libro comprado
    - **`obtenerGanancias`** devuelve `ganancias`
    <br>*/
      class Autor {
        #nombre;
        #nacionalidad;
        constructor(nombre, nacionalidad) {
          this.#nombre = nombre;
          this.#nacionalidad = nacionalidad;
        }
        getNombre() {
          return this.#nombre;
        }
        getNacionalidad() {
          return this.#nacionalidad;
        }
      }
      class Libro {
        #id;
        #titulo;
        #autor;
        #precio;
        #genero;
        #stock;
        constructor(titulo, autor, precio, genero, stock) {
          if (precio < 0 || stock < 0) {
            throw new Error("El precio y el stock no pueden ser menores que 0");
          }
          this.#id = crypto.randomUUID();
          this.#titulo = titulo;
          this.#autor = autor;
          this.#precio = precio;
          this.#genero = genero;
          this.#stock = stock;
        }
        tieneStock() {
          if (this.#stock > 0) {
            return true;
          } else {
            return false;
          }
        }
        getId() {
          return this.#id;
        }
        getTitulo() {
          return this.#titulo;
        }
        getAutor() {
          return this.#autor;
        }
        getPrecio() {
          return this.#precio;
        }
        getGenero() {
          return this.#genero;
        }
        setPrecio(nuevoPrecio) {
          if (nuevoPrecio >= 0) {
            this.#precio = nuevoPrecio;
          } else {
            console.warn("No puedes introducir un precio negativo");
          }
        }
        setStock(nuevoStock) {
          if (nuevoStock >= 0) {
            this.#stock = nuevoStock;
          } else {
            console.warn("No puedes introducir un stock negativo");
          }
        }
        reducirStock() {
          this.#stock -= 1;
          return true;
        }
      }
      class Libreria {
        constructor() {
          this.libros = [];
          this.ganancias = 0;
        }
        agregarLibro(libro) {
          this.libros.push(libro);
        }
        eliminarLibro(id) {
          const index = this.libros.findIndex((libro) => libro.getId() === id);
          if (index !== -1) {
            this.libros.splice(index, 1);
          }
        }
        buscarPorId(id) {
          return this.libros.find((libro) => libro.getId() === id);
        }
        buscarPorTitulo(titulo) {
          return this.libros.find((libro) => libro.getTitulo() === titulo);
        }
        filtrarPorAutor(autor) {
          return this.libros.filter(
            (libro) => libro.getAutor().getNombre() === autor
          );
        }
        filtrarPorGenero(genero) {
          return this.libros.filter((libro) => libro.getGenero() === genero);
        }
        comprarLibros(idsLibros) {
          idsLibros.forEach((element) => {
            let libro = this.buscarPorId(element);
            if (libro && libro.tieneStock()) {
              libro.reducirStock();
              this.ganancias += libro.getPrecio();
            } else {
              console.warn("No hay stock");
            }
          });
        }
        obtenerGanancias() {
          return this.ganancias;
        }
      }
      // Crear autores
      const autor1 = new Autor("Gabriel Garc√≠a M√°rquez", "Colombiana");
      const autor2 = new Autor("Isabel Allende", "Chilena");

      // Crear libros
      const libro1 = new Libro(
        "Cien A√±os de Soledad",
        autor1,
        20,
        "Realismo m√°gico",
        5
      );
      const libro2 = new Libro(
        "La Casa de los Esp√≠ritus",
        autor2,
        18,
        "Novela",
        3
      );

      // Crear librer√≠a y agregar libros
      const libreria = new Libreria();
      libreria.agregarLibro(libro1);
      libreria.agregarLibro(libro2);

      // Armar array de ids de libros a comprar
      const idsLibros = [libro1.getId(), libro2.getId(), libro2.getId()];

      // Comprar los libros
      libreria.comprarLibros(idsLibros);

      console.log("Ganancias:", libreria.obtenerGanancias());
      // üëâ 20 + 18 + 18 = 56

      console.log("Stock libro1:", libro1.tieneStock()); // true (a√∫n quedan 4)
      console.log("Stock libro2:", libro2.tieneStock()); // true (a√∫n quedan 1)
    </script>
  </body>
</html>
